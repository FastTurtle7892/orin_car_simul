slam_toolbox:
  ros__parameters:
    # [시뮬레이션 필수 설정] 가제보 시간을 사용하도록 설정
    use_sim_time: true

    # 1. 핵심: 프레임 이름 맞추기 (이 부분이 문제 해결의 열쇠입니다)
    odom_frame: odom
    map_frame: map
    base_frame: base_link  # SLAM에게 로봇 중심이 base_footprint가 아니라 base_link라고 알려줍니다.
    scan_topic: /scan

    # 2. 매핑 모드 및 성능 설정
    mode: mapping
    map_update_interval: 0.1
    transform_publish_period: 0.02  # TF 발행 주기
    resolution: 0.05
    max_laser_range: 12.0
    minimum_time_interval: 0.5
    transform_timeout: 0.2
    tf_buffer_duration: 30.0

    stack_size_to_use: 40000000 # 메모리 스택 크기 (대규모 맵핑 시 필요)

    correlation_search_space_dimension: 0.5  # (기본값보다 약간 키움)
    correlation_search_space_resolution: 0.01

    # [추가/수정] 루프 클로저(지도 수정) 최소 요건 완화
    # 조금 덜 완벽해도 지도를 겹쳐서 수정하도록 유도
    loop_match_minimum_chain_size: 10
    loop_match_maximum_variance_coarse: 3.0

    # 3. 최적화 및 노이즈 처리
    enable_interactive_mode: true
    solver_plugin: solver_plugins::CeresSolver
    solver_options:
      iterative_refinement_max_passes: 3
